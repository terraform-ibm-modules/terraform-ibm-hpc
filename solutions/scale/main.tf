module "scale" {
  source                                        = "./../.."
  scheduler                                     = "Scale"
  ibm_customer_number                           = var.ibm_customer_number
  zones                                         = var.zones
  remote_allowed_ips                            = var.remote_allowed_ips
  cluster_prefix                                = local.env.cluster_prefix
  ssh_keys                                      = local.env.ssh_keys
  existing_resource_group                       = local.env.existing_resource_group
  vpc_cluster_login_private_subnets_cidr_blocks = local.env.login_subnets_cidr
  vpc_cluster_private_subnets_cidr_blocks       = local.env.compute_subnets_cidr
  cos_instance_name                             = local.env.cos_instance_name
  dns_custom_resolver_id                        = local.env.dns_custom_resolver_id
  dns_instance_id                               = local.env.dns_instance_id
  dns_domain_names                              = local.env.dns_domain_names
  bastion_instance                              = local.env.bastion_instance
  deployer_instance                             = local.env.deployer_instance
  enable_cos_integration                        = local.env.enable_cos_integration
  enable_vpc_flow_logs                          = local.env.enable_vpc_flow_logs
  client_instances                              = local.env.client_instances
  vpc_cidr                                      = local.env.vpc_cidr
  placement_strategy                            = local.env.placement_strategy
  protocol_instances                            = local.env.protocol_instances
  protocol_subnets_cidr                         = [local.env.protocol_subnets_cidr]
  colocate_protocol_instances                   = local.env.colocate_protocol_instances
  static_compute_instances                      = local.env.compute_instances
  storage_instances                             = local.env.storage_instances
  storage_servers                               = local.env.storage_baremetal_server
  storage_subnets_cidr                          = [local.env.storage_subnets_cidr]
  vpc_name                                      = local.env.vpc_name
  compute_gui_password                          = local.env.compute_gui_password
  compute_gui_username                          = local.env.compute_gui_username
  storage_gui_password                          = local.env.storage_gui_password
  storage_gui_username                          = local.env.storage_gui_username
  observability_atracker_enable                 = local.env.observability_atracker_enable
  observability_atracker_target_type            = local.env.observability_atracker_target_type
  sccwp_enable                                  = local.env.sccwp_enable
  sccwp_service_plan                            = local.env.sccwp_service_plan
  cspm_enabled                                  = local.env.cspm_enable
  app_config_plan                               = local.env.app_config_plan
  skip_flowlogs_s2s_auth_policy                 = local.env.skip_flowlogs_s2s_auth_policy
  ibmcloud_api_key                              = local.env.ibmcloud_api_key
  afm_instances                                 = local.env.afm_instances
  afm_cos_config                                = local.env.afm_cos_config
  enable_ldap                                   = local.env.enable_ldap
  ldap_basedns                                  = local.env.ldap_basedns
  ldap_admin_password                           = local.env.ldap_admin_password
  ldap_user_name                                = local.env.ldap_user_name
  ldap_user_password                            = local.env.ldap_user_password
  ldap_server                                   = local.env.ldap_server
  ldap_server_cert                              = local.env.ldap_server_cert
  ldap_instance                                 = local.env.ldap_instance
  scale_encryption_enabled                      = local.env.scale_encryption_enabled
  scale_encryption_type                         = local.env.scale_encryption_type
  gklm_instances                                = local.env.gklm_instances
  storage_type                                  = local.env.storage_type
  scale_encryption_admin_password               = local.env.scale_encryption_admin_password
  key_protect_instance_id                       = local.env.key_protect_instance_id
  filesystem_config                             = local.env.filesystem_config
  existing_bastion_instance_name                = local.env.existing_bastion_instance_name
  existing_bastion_instance_public_ip           = local.env.existing_bastion_instance_public_ip
  existing_bastion_security_group_id            = local.env.existing_bastion_security_group_id
  existing_bastion_ssh_private_key              = local.env.existing_bastion_ssh_private_key
  client_subnets_cidr                           = [local.env.client_subnets_cidr]
  bms_boot_drive_encryption                     = local.env.bms_boot_drive_encryption
  tie_breaker_bm_server_profile                 = local.env.tie_breaker_baremetal_server_profile
  filesets_config                               = local.env.filesets_config
  login_security_group_name                     = local.env.login_security_group_name
  storage_security_group_name                   = local.env.storage_security_group_name
  compute_security_group_name                   = local.env.compute_security_group_name
  client_security_group_name                    = local.env.client_security_group_name
  gklm_security_group_name                      = local.env.gklm_security_group_name
  ldap_security_group_name                      = local.env.ldap_security_group_name
  login_subnet_id                               = local.env.login_subnet_id
  compute_subnet_id                             = local.env.compute_subnet_id
  storage_subnet_id                             = local.env.storage_subnet_id
  protocol_subnet_id                            = local.env.protocol_subnet_id
  client_subnet_id                              = local.env.client_subnet_id
  github_token                                  = local.env.github_token # Delete this variable before pushing to the public repository.
}
